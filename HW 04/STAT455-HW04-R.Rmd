---
output:
  pdf_document:
    fig_caption: yes
header-includes:
  - \usepackage{color}
  - \usepackage{mathtools}
---
```{r, echo=FALSE, results="hide", warning=FALSE, message=FALSE}
library(boot)
library(knitr)
library(xtable)
decimal <- function(x, k) trimws(format(round(x, k), nsmall=k))
dec <- 4
```


# STAT 455 Homework 04 - R Code  
*Martha Eichlersmith*  
2019-11-07

## Problem 3.3
```{r}
shots <- matrix(c(251, 48, 34, 5), nrow=2, ncol=2)
chisq.test(shots, correct=FALSE)
```

```{r, echo=FALSE, eval=FALSE}
r <- 4
c <- 4
income <- c(rep(1,c), rep(2, c), rep(3, c), rep(4, c))
satisf <- c(rep(c(1:4), r))
count <- c(1, 3, 10,  6,
           2, 3, 10,  7,
           1, 6, 14, 12,
           0, 1,  9, 11)
count.m <- matrix(count, nrow=r, ncol=c)
fit <- glm(count~as.factor(income)+as.factor(satisf), family=poisson(link="log"))
#chisq.test(count.m)
stdreschi <- glm.diag(fit)$rp
res.matrix <- matrix(stdreschi, nrow=r, ncol=r)
res.matrix
```

```{r, message=FALSE}
r <- 5
c <- 2
names.r <- c("Schizophrenia", "Affective disorder", "Neurosis", "Personality disorder", "Special Systems")
names.c <- c("Drugs", "No Drugs")
row <- c(rep(1,c), rep(2, c), rep(3, c), rep(4, c), rep(5, c)) #row  data
column <- c(rep(c(1:2), r)) # column data
count <- c(105, 8, 12, 2, 18, 19, 47, 52, 0, 13)
count.m <- matrix(count, nrow=r, ncol=c)
rownames(count.m) <- names.r 
colnames(count.m) <- names.c
#kable(decimal(count.m, 0))
fit <- glm(count~as.factor(row)+as.factor(column), family=poisson(link="log"))
#fit <- glm(count~row+column, family=poisson(link="log"))
stdreschi <- glm.diag(fit)$rp #need book package 
res.matrix <- matrix(stdreschi, nrow=r, ncol=c)
rownames(res.matrix) <- names.r 
colnames(res.matrix) <- names.c
#kable(decimal(res.matrix, dec))
```


```{r, message=FALSE}
sas.output <- c(9.6581707557,-9.658172142, -6.305326356, 6.3053181409,-6.175979063, 
                6.1759778024,1.3491005584,-1.349107017, 0.6542325397,-0.65423254)
cbind(sas.output, stdreschi, sas.output - stdreschi)
```

```{r, echo=FALSE, eval=FALSE}
xtable(count.m, digits=0, align=c("l", "r", "r"))
xtable(decimal(res.matrix, 4), align=c("l", "r", "r"))
```

